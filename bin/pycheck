#!/usr/bin/env bash

locked_print() {
  flock -e /tmp/pycheck.lock cat
}
export -f locked_print
PYLINT_ARGS=""
test -f setup.cfg && PYLINT_ARGS="--rcfile=setup.cfg"

isort -l80 -m3 --tc "${@}"
(mypy --ignore-missing-imports --disallow-untyped-defs "${@}" | locked_print) &
(pylint "${PYLINT_ARGS}" "${@}" | locked_print) &

wait
